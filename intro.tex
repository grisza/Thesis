
\chapter{Wstęp}\label{chap:intro}
Śledzenie ruchu człowieka w~systemach komputerowych jest rozumiane jako proces obliczeniowy, którego celem jest jednoznaczne i~pozbawione znaczących opóźnień szacowanie położenia stawów układu szkieletowego człowieka w~przestrzeni i~w~czasie. Dysponując położeniem stawów w~czasie i~modelem układu kostnego człowieka można oszacować kolejne pozy postaci oraz ich zmianę - ruch postaci.

Jednym z~pionierów śledzenia ruchu człowieka był psycholog Gunnar Johansson, który w~roku 1973 stworzył system śledzenia ruchu człowieka bazujący na kamerze wideo rejestrującej ruch markerów odbijających światło i~przyczepionych do ciała śledzonej postaci \cite{Johansson1973}. System, zaproponowany wówczas na potrzeby eksperymentu prowadzonego przez Johanssona, w~formie udoskonalonej jest stosowany z~powodzeniem współcześnie. Technologia pierwotnie wykorzystywana do badania i~analizy ruchu kończyn, z~czasem wyewoluowała w~stronę zaawansowanych systemów używanych przez profesjonalistów do tworzenia animacji, czy analizy ruchu w~zastosowaniach sportowych (trening sportowy) oraz medycznych (telerehabilitacja). Jest popularna również wśród amatorów, którzy w zaciszu swoich domów stosują ją do interakcji z komputerem między innymi w~grach oraz w~środowiskach wirtualnych.

W trakcie wielu lat prac i~badań związanych z~\textbf{systemami śledzenia ruchu} zostały opracowane techniki oparte zarówno o~analizę danych wizyjnych (optyczne systemy śledzenia ruchu), jak i~te niewymagające rejestratorów optycznych (między innymi: inercyjne systemy śledzenia ruchu).

Ponad 40 lat rozwoju tej dziedziny pozwoliło na stworzenie wielu rodzajów systemów śledzących ruch postaci począwszy od systemów wizyjnych wspieranych markerami oraz tzw. bezmarkerowych, systemów inercyjnych i~radiowych, aż po zaawansowane egzo-szkielety śledzące ruch człowieka w~sposób mechaniczny. Stosowana w systemach śledzenia ruchu technologia obserwacji ruchu śledzonej osoby stanowi jedno z~kryteriów podziału systemów śledzenia ruchu. Diagram przedstawiony na rysunku \ref{fig:literature:mocapSystems:diagram} przedstawia taksonomię systemów śledzenia ze względu na kryterium użytej technologii.

\begin{savenotes}
	\begin{figure}[H]
		\centering
		\input{images/mocapSystemsDiagram}
		\caption{Podział systemów śledzenia ruchu ze względu na technologię pobierania danych}
		\label{fig:literature:mocapSystems:diagram}
	\end{figure}
\end{savenotes}
Prowadzone są również badania nad systemami \textbf{hybrydowymi}, które łączą ze sobą kilka rodzajów urządzeń pomiarowych mogących się nawzajem uzupełniać w~czasie śledzenia ruchu, co ma na celu zmniejszenie ograniczeń ich działania i~zwiększenie dokładności oszacowania położenia poszczególnych stawów.

Niniejsza praca poświęcona została hybrydowemu systemowi śledzenia ruchu, łączącemu dane uzyskane za pomocą sensora głębi, umieszczonego w~kontrolerze Microsoft Kinect, z~danymi uzyskanymi z~\textbf{autonomicznych czujników inercyjnych} działających w~ramach samodzielnie stworzonych urządzeń pomiarowych, bazujących na platformie Arduino. Autonomicznymi czujnikami inercyjnymi nazywamy moduły mierzące prędkość z~jaką obraca się dany komponent, za pomocą wbudowanego żyroskopu oraz sił na niego działających za pomocą wbudowanego akcelerometru. Dzięki odniesieniu działających sił do siły grawitacji, można określić przybliżone przyspieszenie akcelerometru.
Zazwyczaj akcelerometr i~żyroskop połączone są ze sobą jako jedno urządzenie pomiarowe (moduł IMU -- \emph{ang. Inertial Measurement Unit}) umieszczone w~niewielkim pudełku. W~rozważanym systemie moduły IMU zostały umieszczone na ciele (kończynach) śledzonej postaci, jako urządzenia pomiarowe uzupełniające kontroler Kinect. Elementy umieszczane na ciele śledzonej postaci, umożliwiające śledzenie jej ruchu, noszą nazwę \textbf{modułów inercyjnych}. Moduły inercyjne mogą mieć różną konstrukcję, która zależy od technologii wykorzystywanej w~danym systemie śledzenia ruchu.\\

\section{Problematyka pracy}
Głównym problemem z~jakim zmagają się twórcy systemów śledzenia ruchu człowieka jest precyzyjne oszacowanie położenia stawów szkieletu postaci w~przestrzeni. Precyzja systemu śledzenia ruchu postaci uzależniona jest w dużej mierze od charakterystyk działania wykorzystywanych w~nim urządzeń pomiarowych. W~przypadku opisywanego w~niniejszej pracy hybrydowego systemu śledzenia ruchu, wykorzystującego kontroler Kinect oraz czujniki inercyjne, problemami, na które należało zwrócić uwagę są między innymi: dokładność urządzeń pomiarowych oraz ograniczone możliwości śledzenia kończyn w~przypadku przesłaniania się części ciała - główny problem kontrolera Kinect. Dodatkowo istotnym problemem jest zaszumienie pomiarów uzyskiwanych z~czujników inercyjnych oraz łączenie danych uzyskanych ze wszystkich urządzeń pomiarowych w~taki sposób, aby uzyskane oszacowanie położenia stawów w~przestrzeni było jak najbardziej precyzyjne w~odniesieniu do rzeczywistego ich położenia.\\

Jedną z~inspiracji dla niniejszej pracy i~jednocześnie przykładowym zastosowaniem tworzonego systemu była pomoc przy rehabilitacji ruchowej. Zadaniem systemu byłoby umożliwienie pacjentowi wykonywania ćwiczeń we własnym domu z~zapewnieniem weryfikacji poprawności wykonywanych ruchów. Cechą charakterystyczną takich ćwiczeń jest ich wolne tempo powiązane z~rygorem dokładnego ich wykonywania \cite{Reinkensmeyer2012}. Ten sam autor wskazuje, że rehabilitacja wspomagana systemem śledzenia ruchu pozwala na zindywidualizowanie ćwiczeń dla konkretnego pacjenta. Z~kolei Malouin \cite{Malouin2003} wskazuje, że systemy pozwalające na zautomatyzowany nadzór wykonywanych ćwiczeń rehabilitacyjnych pozwalają na przyspieszenie ich wdrożenia w~terapię oraz zintensyfikowanie ćwiczeń, co ma pozytywny wpływ na powrót pacjenta do pełni zdrowia.

\section{Cel i~teza pracy}
Celem niniejszej pracy było opracowanie metody połączenia sygnałów z~wybranych urządzeń pomiarowych: kontrolera Kinect i~czujników inercyjnych, która działa z~częstotliwością porównywalną do częstotliwości pracy kontrolera Kinecta (30 Hz) i~zapewnia wysoką, wyższą niż u innych autorów, dokładność oszacowania położenia śledzonych stawów układu kostnego człowieka. W~konsekwencji śledzenie wykonywanych przez postać ruchów byłoby bardziej precyzyjne. Ruchy kończyn powinny być realizowane w~tempie charakterystycznym dla ćwiczeń rehabilitacyjnych, aby zastosowanie zaproponowanych urządzeń pomiarowych było zasadne. Gdyby prędkość ruchu kończyn przekroczyłaby zdolność rejestracji któregoś z~wybranych urządzeń pomiarowych należałoby zastąpić je urządzeniami o~wyższej częstotliwości rejestracji pomiarów. Nie ogranicza to jednak zastosowania metody do łączenia danych pochodzących z~innych urządzeń, pod warunkiem, że charakter zwracanych danych pomiarowych będzie analogiczny. 

Zgodnie z~powyższymi celami oraz analizą dostępnej literatury została postawiona następująca teza:\\
\begin{center}
	\textbf{Zastosowanie autorskiej, hybrydowej metody śledzenia ruchu kończyn człowieka, łączącej dane pochodzące z~sensora głębi i~sensorów inercyjnych, uwzględniającej kontekstowe charakterystyki pracy urządzeń, pozwala na bardziej precyzyjne, niż w~przypadku innych metod, śledzenie ich ruchu.}
\end{center}

W ramach pracy została opracowana i~zaimplementowana autorska metoda przetwarzania i~łączenia ze sobą sygnałów z~inercyjnych czujników ruchu oraz kontrolera Kinect. Metoda stosuje informacje o~obrotach segmentów kończyn ciała aktora i~w~połączeniu z~oszacowanym modelem kostnym pozwala na obliczenie pozycji stawów układu szkieletowego człowieka. 
Jako przykład został wybrany i~zbadany ruch prawej ręki bez śledzenia ruchu dłoni. Metoda ta została porównana z~autorską implementacją hybrydowej metody śledzenia ruchu o~najwyższej deklarowanej w literaturze dokładności, i~wykorzystującej analogiczne urządzenia pomiarowe.\\

\section{Struktura pracy}
Niniejsza dysertacja została podzielona na 5 rozdziałów. Poza wstępem kolejne części dotyczą: analizy aktualnego stanu zagadnienia, przedstawienia autorskiej hybrydowej metody śledzenia ruchu oraz weryfikacji skuteczności opracowanej metody zwieńczonej podsumowaniem niniejszej pracy. 

Analiza aktualnego stanu zagadnienia (rozdział \ref{chap:literature}) zawiera omówienie istniejących systemów śledzenia ruchu (rozdział \ref{sec:literature:mocapSystems}), sposobów reprezentacji ciała człowieka w~systemach komputerowych (rozdział \ref{chap:bodyRep}) analizę charakterystyk pracy i~budowy kontrolera Microsoft Kinect oraz~czujników inercyjnych (rozdział \ref{chap:characteristics}), a~także analizę istniejących w~literaturze realizacji hybrydowych systemów śledzenia ruchu człowieka wykorzystujących te same lub analogiczne urządzenia pomiarowe (rozdział \ref{sec:literature:hybrids}). Należy w~tym miejscu zaznaczyć, że opisane w~pracy charakterystyki kontrolera Kinect i~czujników inercyjnych, zostały w~znacznej mierze wyznaczone na bazie własnych badań oraz na podstawie wiedzy dostępnej w~literaturze.

Kolejny rozdział (rozdział \ref{chap:hybrid}), przedstawiający autorską hybrydową metodę śledzenia ruchu, wykorzystującą kontroler Microsoft Kinect i~czujniki inercyjne, zawiera omówienie kolejnych etapów przetwarzania i~łączenia danych uzyskanych z~urządzeń pomiarowych. Kolejne podrozdziały zostały poświęcone akwizycji danych pomiarowych i~ich formatom, dyskusji dotyczących kwestii kalibracji urządzeń oraz etapom korekcji pozyskanych danych, ich synchronizacji czasowej oraz ich finalne łączenie mające na celu oszacowanie położenia wybranych stawów ręki. 

Rozdział czwarty (rozdział \ref{chap:experiments}) zawiera opis badań eksperymentalnych wraz z~wynikami i~ich omówieniem. Kolejny rozdział zawiera podsumowanie dysertacji wraz z~propozycją zidentyfikowanych przez autora dalszych kierunków badań związanych z~omawianą metodą.\\

Praca zawiera także 2 rozdziały dodatkowe, mające na celu przedstawienie informacji pomocnych w~analizie przedstawionego tematu. Pierwszym z~nich (dodatek \ref{chap:appx:filters}) jest opis podstawowych filtrów stosowanych do łączenia sygnałów, a~wykorzystywanych w~przytoczonych w~niniejszej pracy artykułach. Drugim (dodatek \ref{chap:appx:allan}) jest przybliżenie wariancji Allana będącej narzędziem pozwalającym na analizę charakterystyki szumów między innymi czujników inercyjnych.